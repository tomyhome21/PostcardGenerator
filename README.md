# ハガキ宛名印刷ツール

このツールは、CSV形式の住所録データから、ハガキの宛名面を自動で生成し、PDFファイルとして出力します。自宅にプリンターがない方でも、コンビニエンスストアのマルチコピー機などで手軽に印刷できるよう設計されています。

---

✨ **特徴**

* **CSV住所録からの自動生成**: 氏名、郵便番号、住所をCSVから読み込み、ハガキの宛名面を自動で作成します。
* **柔軟な連名対応**: 複数の宛名（連名）にも対応しており、レイアウトを調整できます。「氏名２」列に名字と名前をスペース区切りで入力した場合、名字も表示されます。名字が不要な場合は名前のみを入力してください。
* **敬称の個別指定（連名対応）**: 「敬称」列で氏名１の敬称を、「敬称２」列で氏名２（連名）の敬称を個別に指定できます。空欄の場合は何も表示されません。
* **氏名・敬称のY座標自動調整**: 氏名１と氏名２（連名）の名字や名前の長さに応じて、名前の開始位置と敬称のY座標を自動で揃えるため、バランスの取れたレイアウトを維持します。
* **郵便番号の柔軟な入力**: 郵便番号は、ハイフンの有無にかかわらず自動的に認識・処理されます。（例: `123-4567` も `1234567` もどちらも使用可能です。）
* **エンコーディング自動検出**: Shift-JISとUTF-8のCSVファイルを自動で判別し、文字化けを気にせず読み込めます。
* **レイアウトの柔軟な調整**: フォントサイズ、文字間隔、配置などを細かくカスタマイズ可能です。
* **PDF出力**: 生成された宛名面はPDF形式で出力されるため、汎用性が高く、コンビニプリントにも対応します。
* **テンプレート自動生成**: ハガキテンプレートを自動で生成するため、別途画像を用意する必要がありません。

---

🚀 **ツールのダウンロードと使い方**

### ツールをダウンロードする

本ツールはPython環境がなくてもすぐに使える**実行ファイル（EXEファイル）**として提供しています。フォントにはウェブ標準の「Noto Sans JP」を同梱しているため、別途フォントファイルを用意したり配置したりする必要はありません。

以下の手順でダウンロードしてください。

1.  このGitHubリポジトリの「[Releases（リリース）](https://github.com/YOUR_USERNAME/YOUR_REPOSITORY_NAME/releases)」セクションにアクセスします。
2.  最新のリリース版にある `postcard_generator.exe` ファイルをダウンロードしてください。

**ポイント**: ダウンロードしたEXEファイルは、セキュリティソフトによっては「危険なファイル」と警告される場合があります。これはPythonで作成された実行ファイルによくある警告です。本ツールは安全ですので、警告が表示されても続行してダウンロードしてください。

### ツールの準備

ダウンロードした `postcard_generator.exe` ファイルを、任意のわかりやすいフォルダ（例: デスクトップやドキュメントフォルダ内の新しいフォルダ）に置いてください。

スクリプトと同じディレクトリに `generated_postcard_template.jpg` というテンプレート画像が自動生成されます（これはPDF生成の内部的な中間ファイルとして利用されます）。

### CSV住所録ファイルを作成する

ハガキに差し込む住所録データはCSV形式で用意します。

* ExcelやGoogleスプレッドシートなどで作成した住所録から、CSV形式でエクスポートできます。
* 以下のヘッダー名を使用してください。列の順番は問いません。
* 「氏名」列には、名字と名前の間に半角または全角スペースを1文字以上開けてください。
* 「氏名２」列には、名字と名前をスペース区切りで入力してください。名字が不要な場合は名前のみで構いません。

**必須列**: `氏名`, `郵便番号`, `住所１`
**オプション列**: `氏名２` (連名用), `住所２`, `敬称` (個別指定用), `敬称２` (連名用敬称)

**コード スニペット**

```csv
氏名,氏名２,郵便番号,住所１,住所２,敬称,敬称２
山田 太郎,,100-0001,東京都千代田区千代田1-1,皇居,様,
田中 花子,一郎,200-0002,大阪府大阪市中央区中央1-1,大阪城ビルディング5F,様,
鈴木商店,,300-0003,神奈川県横浜市中区横浜町1-2-3,鈴木ビル1F,御中,
佐藤 健,愛,400-0004,北海道札幌市中央区大通西1-1,大通公園タワー10F,様,
加藤 雅人,陽子,500-0005,福岡県福岡市博多区博多駅中央街1-1,,様,
木村 拓哉,工藤 静香,600-0006,京都府京都市中京区河原町通1-1,京都タワーレジデンス20F,様,様
伊藤 太郎,伊藤 次郎,700-0007,広島県広島市中区紙屋町1-1,平和ビル3F,様,
````

### ハガキ宛名PDFを生成する

1.  `postcard_generator.exe` をダブルクリックして起動します。
2.  画面の指示に従い、作成した住所録CSVファイルを選択し、出力先のPDFファイルを指定してください。

### 位置の調整と試し印刷（上級者向け）

もし、生成されたPDFファイルの文字位置がずれているなど、さらに調整したい場合は、ご自身でPython環境をセットアップし、スクリプトのソースコードを編集する必要があります。

スクリプト内の\*\*「描画位置の調整」\*\*セクションにある座標やオフセット、フォントサイズなどを調整してください。

  * **X軸**: 数値を大きくすると右へ、小さくすると左へ移動します。
  * **Y軸**: 数値を大きくすると下へ、小さくすると上へ移動します。

-----

⚙️ **スクリプト内の設定項目（ソースコードを編集する場合）**

`postcard_generator.py` ファイルの先頭にある「設定項目」セクションで、以下の値をカスタマイズできます。

  * `GENERATE_TEMPLATE`: `True` にするとテンプレートを自動生成。`False` にすると手動で用意した `template_postcard.jpg` を読み込みます。
  * `AUTO_TEMPLATE_FILENAME`: 自動生成されるテンプレートのファイル名。
  * `TEMPLATE_DPI`: 自動生成テンプレートのDPI（印刷品質に影響）。
  * `POSTCARD_WIDTH_MM`, `POSTCARD_HEIGHT_MM`: 自動生成テンプレートの物理的なサイズ（ミリメートル）。
  * `FONT_FILENAME`: 使用するフォントファイル名（例: `'NotoSansJP-Regular.otf'`）。本EXEに同梱されている「Noto Sans JP」フォントを使用する場合は、この値を変更する必要はありません。 別のフォントを使用したい場合にのみ、ここに新しいフォントファイルの正確なファイル名（例: `'YourFontName.ttf'`）と、そのフォントファイルをPyInstallerで同梱する設定が必要です。
  * `NAME_FONT_SIZE` など: 各テキストのフォントサイズ
  * `TEXT_COLOR`: テキストの色（RGB値）
  * `ZIP_POS_TOP_LEFT`, `ZIP_POS_BOTTOM_LEFT`, `ZIP_CHAR_OFFSETS_3DIGIT`, `ZIP_CHAR_OFFSETS_4DIGIT`: 郵便番号の描画位置と文字間隔。
  * `ADDRESS_COL1_X`, `ADDRESS_COL2_X`, `ADDRESS_LINE_Y_START`, `ADDRESS_CHAR_Y_SPACING`: 住所の描画位置と文字間隔。
  * `NAME_COL1_X`, `NAME_COL2_X`, `NAME_LINE_Y_START`, `NAME_CHAR_Y_SPACING`: 氏名の描画位置と文字間隔。
  * `OFFSET_NAME1_Y_FROM_SURNAME_END_AFTER_SPACE`: 名字と氏名1の名前の間の縦方向オフセット。
  * `OFFSET_NAME2_X_FROM_NAME1_COL`: 氏名1の列から氏名2（連名）の列までの横方向オフセット。
  * `OFFSET_TITLE_Y_FROM_NAME_END`: 氏名1の名前の末尾から敬称までの縦方向オフセット。
  * `DEFAULT_TITLE`: CSVに敬称が指定されていない場合のデフォルト敬称。

-----

🎥 **YouTubeでの紹介**

このスクリプトは、Canvaでハガキの裏面をデザインし、このツールで宛名面を生成、そしてセブンイレブンで手軽にプリントするという一連の便利なワークフローを実現します。プリンターをお持ちでない方や、少量だけこだわりのはがきを作成したい方に特におすすめです。

詳細な使い方や各ステップの解説は、以下のYouTube動画で詳しく解説しています。ぜひご覧ください！

  * ハガキ差し込み印刷スクリプトの紹介: [URL](https://www.youtube.com/watch?v=xxxxxxxx) 
  * 【もう迷わない！】Googleフォトの写真をCanvaで素敵に飾る方法 - 簡単連携ガイド: [URL](https://youtu.be/QPr9As0V2hg) 
  * 【超簡単】Googleフォト写真をセブン-イレブンで即プリント！スマホとQRコードで完結！ [URL](https://youtu.be/KGGtGMDfG6k)
